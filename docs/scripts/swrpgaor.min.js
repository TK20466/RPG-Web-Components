function addSkillDirective(e,t,i){app.directive(i,function(){return{restrict:"A",link:function(a,n,l){var r=1;l[i]&&(r=parseInt(l[i])),a.$parent.model.skills[e]={rank:r,attribute:t}}}})}var app=angular.module("swaor",[]);app.directive("skills",function(){return{replace:!0,restrict:"E",link:function(e,t,i){e.$parent.model.skills={},e.skills=e.$parent.model.skills}}}),app.directive("skillsBlock",function(){return{templateUrl:"/views/skills.html",replace:!0,restrict:"E",link:function(e,t,i){e.skills=e.model.skills,e.skillKeys=function(){var t=[];for(k in e.model.skills)t.push(k);return t.sort()},e.char=e.model,e.getAttr=function(t){return e.char[e.skills[t].attribute]}}}}),app.directive("skill",function(){return{templateUrl:"/views/skill.html",replace:!0,restrict:"E",scope:{name:"=",rank:"=",abty:"=",minion:"=?",hideRank:"=?"},controller:["$scope",function(e){if(e.pdice=new Array(e.rank),e.abty>e.rank)e.adice=new Array(e.abty-e.rank),e.pdice=new Array(e.rank);else{e.adice=new Array(e.rank-e.abty),e.pdice=new Array(Math.min(e.rank,e.abty));for(var t=Math.floor(e.adice.length/2),i=0;i<t;i++)e.pdice.push(""),e.adice.pop(),e.adice.pop()}}]}}),app.directive("statblock",function(){return{templateUrl:"/views/statblock.html",scope:{value:"=value",display:"@display"},replace:!0}}),app.directive("dynamic",["$compile",function(e){return{restrict:"A",replace:!0,link:function(t,i,a){t.$watch(a.dynamic,function(a){i.html(a),e(i.contents())(t)})}}}]),app.directive("talentBlock",function(){return{templateUrl:"/views/talents.html",scope:{talents:"=?talents"},replace:!0}}),app.directive("talents",["$sce",function(e){return{transclude:!0,restrict:"E",link:function(t,i,a,n,l){l(t,function(t,i){for(var a="",n=0;n<t.length;n++)a+=t[n].wholeText||t[n].outerHTML;i.$parent.model.talents=e.trustAsHtml(a)})}}}]),app.directive("abilitiesBlock",function(){return{templateUrl:"/views/abilities.html",scope:{abilities:"=?abilities"},replace:!0}}),app.directive("equipmentBlock",["getSkillStat",function(e){return{templateUrl:"/views/equipment.html",scope:{equipment:"=?equipment"},controller:["$scope",function(t){t.getRank=function(e){return void 0==t.$parent.skills[e]?0:t.$parent.skills[e].rank},t.getAbility=function(i){var a=e(i);return t.$parent.model[a]},t.isMinion=function(){return"minion"==t.$parent.rank}}],replace:!0}}]),app.directive("abilities",["$sce",function(e){return{transclude:!0,restrict:"E",link:function(t,i,a,n,l){l(t,function(t,i){for(var a="",n=0;n<t.length;n++)a+=t[n].wholeText||t[n].outerHTML;i.$parent.model.abilities=e.trustAsHtml(a)})}}}]),app.directive("weapon",["$sce",function(e){return{transclude:!0,reaplce:!0,restrict:"E",scope:{name:"@",skill:"@",damage:"=",critical:"=?",range:"@",blast:"=?",stun:"=?",quantity:"=?",pierce:"=?",vicious:"=?",autoFire:"=?autoFire",limitedAmmo:"=?ammo"},link:function(t,i,a,n,l){var r={name:t.name,skill:t.skill,damage:t.damage,critical:t.critical,range:t.range,blast:t.blast,quantity:t.quantity,pierce:t.pierce,ammo:t.limitedAmmo,autoFire:t.autoFire,vicious:t.vicious};l(t,function(t,i){for(var a="",n=0;n<t.length;n++)a+=t[n].wholeText||t[n].outerHTML;r.text=e.trustAsHtml(a)});var s=t.$parent.$parent.model;null==s.equipment&&(s.equipment={}),null==s.equipment.weapons&&(s.equipment.weapons=[]),s.equipment.weapons.push(r)}}}]),app.directive("detailBlock",function(){return{templateUrl:"/views/detailblock.html",scope:{value:"=value",display:"@display"},replace:!0}}),app.directive("detailbar",function(){return{templateUrl:"/views/detailbar.html",scope:{model:"=model"},replace:!0}}),app.directive("statbar",function(){return{templateUrl:"/views/statbar.html",scope:{model:"=model"},replace:!0}}),app.directive("die",function(){return{templateUrl:"/views/diesymbol.html",scope:{symbol:"@type"},restrict:"E",replace:!0}}),app.directive("setback",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="setback"}]}}),app.directive("boost",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="boost"}]}}),app.directive("ability",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="ability"}]}}),app.directive("difficulty",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="difficulty"}]}}),app.directive("challenge",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="challenge"}]}}),app.directive("proficiency",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="proficiency"}]}}),app.directive("success",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="success"}]}}),app.directive("failure",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="failure"}]}}),app.directive("advantage",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="advantage"}]}}),app.directive("threat",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="threat"}]}}),app.directive("triumph",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="triumph"}]}}),app.directive("despair",function(){return{templateUrl:"/views/diesymbol.html",replace:!0,scope:{},restrict:"E",controller:["$scope",function(e){e.symbol="despair"}]}}),app.directive("check",function(){return{templateUrl:"/views/check.html",replace:!0,scope:{skill:"@skill",dif:"@dif",chg:"@chg"},controller:["$scope",function(e){var t=parseInt(e.dif);switch(e.difficulty_text="",e.pdice=new Array(parseInt(t)),e.chg&&(e.cdice=new Array(parseInt(e.chg)),t+=parseInt(e.chg)),e.dif=t,t){case 0:e.difficulty_text="Simple";break;case 1:e.difficulty_text="Easy";break;case 2:e.difficulty_text="Average";break;case 3:e.difficulty_text="Hard";break;case 4:e.difficulty_text="Daunting";break;default:e.difficulty_text="Formidable"}}]}}),app.directive("npc",function(){return{templateUrl:"/views/npc.html",replace:!0,transclude:!0,scope:{model:"=?",name:"@",rank:"@",brawn:"=?",agility:"=?",intellect:"=?",cunning:"=?",willpower:"=?",presence:"=?",wounds:"=?",soak:"=?",strain:"=?"},controller:["$scope",function(e){null==e.model&&(e.model={name:e.name,rank:e.rank||"rival",brawn:e.brawn||1,agility:e.agility||1,intellect:e.intellect||1,cunning:e.cunning||1,willpower:e.willpower||1,presence:e.presence||1,wounds:e.wounds||10,soak:e.soak,strain:e.strain,skills:{}})}]}}),app.directive("blackbox",function(){return{templateUrl:"/views/blackbox.html",replace:!0,transclude:!0,scope:{header:"@title"}}}),app.directive("narrative",function(){return{templateUrl:"/views/redbox.html",replace:!0,transclude:!0,restrict:"E",scope:{header:"@title"}}});var skillsTree=function(){return[{name:"Astrogation",attribute:"intelligence"},{name:"Athletics",attribute:"brawn"},{name:"Charm",attribute:"presence"},{name:"Coercion",attribute:"willpower"},{name:"Computers",attribute:"intelligence"},{name:"Cool",attribute:"presence"},{name:"Coordination",attribute:"agility"},{name:"Deception",attribute:"cunning"},{name:"Discipline",attribute:"willpower"},{name:"Leadership",attribute:"presence"},{name:"Mechanics",attribute:"intelligence"},{name:"Medicine",attribute:"intelligence"},{name:"Negotiation",attribute:"presence"},{name:"Perception",attribute:"cunning"},{name:"Piloting (Planetary)",attribute:"agility",alias:"pilotingPlanetary"},{name:"Piloting (Space)",attribute:"agility",alias:"pilotingSpace"},{name:"Resilience",attribute:"brawn"},{name:"Skulduggery",attribute:"cunning"},{name:"Stealth",attribute:"agility"},{name:"Streetwise",attribute:"cunning"},{name:"Survival",attribute:"cunning"},{name:"Vigilance",attribute:"willpower"},{name:"Brawl",attribute:"brawn"},{name:"Gunnery",attribute:"agility"},{name:"Melee",attribute:"brawn"},{name:"Ranged (Light)",attribute:"agility",alias:"rangedLight"},{name:"Ranged (Heavy)",attribute:"agility",alias:"rangedHeavy"},{name:"Core Worlds",attribute:"intelligence",alias:"coreWorlds"},{name:"Education",attribute:"intelligence"},{name:"Lore",attribute:"intelligence"},{name:"Outer Rim",attribute:"intelligence",alias:"outerRim"},{name:"Underworld",attribute:"intelligence"},{name:"Xenology",attribute:"intelligence"}]};app.factory("skillInfo",[function(){return skillsTree()}]),app.service("getSkillStat",["skillInfo",function(e){return function(t){for(var i=0;i<e.length;i++)if(e[i].name.toLowerCase()==t.toLowerCase())return e[i].attribute}}]);for(var skills=skillsTree(),i=0;i<skills.length;i++){var name=skills[i].alias;null!=name&&"undefined"!=name||(name=skills[i].name.toLowerCase()),addSkillDirective(skills[i].name,skills[i].attribute,name)}!function(){"use strict";function e(e){for(var t=e.firstChild;t&&"TH"!==t.tagName;){if("TD"===t.tagName){t=null;break}t=t.nextSibling}return t}function t(e){return[].filter.call(e.children().children().children(),function(e){return"TH"===e.tagName})}function i(e,t){var i=t&&t.textContent;!i||!e.getAttributeNode("data-title-override")&&e.getAttributeNode("data-title")||(e.setAttribute("data-title",i),e.setAttribute("data-title-override",i))}function a(e){var t=e.getAttributeNode("colspan");return t?parseInt(t.value):1}function n(){return{restrict:"A",controller:["$element",function(i){return{contains:function(e){var t=i[0],a=e;do{if(a===t)return!0;if("TABLE"===a.tagName)return!1;a=a.parentElement}while(a);throw new Error("Table element not found for "+e)},getHeader:function(n){var l=e(n.parentElement);if(l)return l;var r=t(i);if(r.length){var s=n.parentElement,c=0;return Array.prototype.some.call(s.children,function(e,t){return"TD"===e.tagName&&(e===n||void(c+=a(e)))})?r[c]:null}}}}],compile:function(n,l){l.$addClass("responsive");var r=t(n);if(r.length){var s=[].filter.call(n.children(),function(e){return"TBODY"===e.tagName})[0].children;Array.prototype.forEach.call(s,function(t){var n=0;[].forEach.call(t.children,function(t,l){if("TD"===t.tagName){var s=e(t.parentElement);s=s||r[n],i(t,s),n+=a(t)}})})}}}}function l(){return{restrict:"E",require:"?^^wtResponsiveTable",link:function(e,t,a,n){n&&n.contains(t[0])&&setTimeout(function(){[].forEach.call(t[0].parentElement.children,function(e){if("TD"===e.tagName){i(e,n.getHeader(e))}})},0)}}}angular.module("wt.responsive",[]).directive("wtResponsiveTable",[n]).directive("td",[l])}(),angular.module("swaor").run(["$templateCache",function(e){e.put("/views/abilities.html",'<div class="npc-abilities"><div class="npc-details-bold">Abilities:</div><div class="npc-details-normal" ng-if="abilities" dynamic="abilities"></div><div class="npc-details-normal" ng-if="!abilities">None.</div></div>'),e.put("/views/blackbox.html",'<div class="cornered blackbox"><h4 ng-if="header">{{header}}</h4><p ng-transclude></p></div>'),e.put("/views/check.html",'<span class="check">{{difficulty_text}} (<span ng-repeat="c in cdice track by $index"><challenge></span><span ng-repeat="p in pdice track by $index"><difficulty></span>) <span class="skill-name">{{skill}}</span> check</span>'),e.put("/views/detailbar.html",'<div class="detail-bar"><detail-block ng-if="model.soak" value="model.soak" display="soak"></detail-block><detail-block ng-if="model.wounds" value="model.wounds" display="w. threshold"></detail-block><detail-block ng-if="model.strain" value="model.strain" display="s. threshold"></detail-block></div>'),e.put("/views/detailblock.html",'<div class="detail-block"><div class="detail-block-text">{{display}}</div><div class="detail-block-value">{{value}}</div></div>'),e.put("/views/diesymbol.html",'<i class="die-symbol" ng-class="symbol"></i>'),e.put("/views/equipment.html",'<div class="npc-equipment"><div class="npc-details-bold">Equipment:</div><div class="npc-details-normal" ng-if="equipment && equipment.weapons" ng-repeat="item in equipment.weapons"><span class="weapon-name"><span ng-if="item.quantity">{{item.quantity}} </span>{{item.name}} </span><span class="weapon-details">(<skill hide-rank="true" name="item.skill" rank="getRank(item.skill)" abty="getAbility(item.skill)" minion="isMinion()"></skill>; Damage: {{item.damage}}; Critical: {{item.critical}}; Range [<span class="weapon-range">{{item.range}}</span>]; <span ng-if="item.pierce">Piece {{item.pierce}};</span> <span ng-if="item.blast">Blast {{item.blast}};</span> <span ng-if="item.vicious">Vicious {{item.vicious}};</span> <span ng-if="item.ammo">Limited Ammo {{item.ammo}};</span> <span ng-if="item.autoFire">Auto Fire;</span> <span ng-if="item.stun">Stun setting</span> <span dynamic="item.text"></span>)</span></div><div class="npc-details-normal" ng-if="!equipment">None.</div></div>'),e.put("/views/npc.html",'<div class="npc-wrapper"><h4 ng-if="model.name">{{model.name}} <span ng-if="model.rank">[{{model.rank}}]</span></h4><statbar model="model"></statbar><detailbar model="model"></detailbar><ng-transclude></ng-transclude><skills-block></skills-block><talent-block talents="model.talents"></talent-block><abilities-block abilities="model.abilities"></abilities-block><equipment-block equipment="model.equipment"></equipment-block></div>'),e.put("/views/planet.html",'<md-slider-container><div flex="10" layout layout-align="center center"><span class="md-body-1">Scarcity</span></div><md-slider flex md-discrete ng-model="item" step="1" min="-2" max="4" aria-label="Scarcity"></md-slider><scarcity-display value="item" flex></scarcity-display></md-slider-container>'),e.put("/views/rarity.html",'<md-slider-container><div flex="10" layout layout-align="center center"><span class="md-body-1">Rarity</span></div><md-slider flex md-discrete ng-model="item" step="1" min="1" max="10" aria-label="Rarity"></md-slider><md-input-container><input disabled="disabled" flex type="number" ng-model="item" aria-label="green" aria-controls="green-slider"></md-input-container></md-slider-container>'),e.put("/views/redbox.html",'<div class="center-children redbox-wrapper"><div class="cornered redbox"><p ng-transclude></p></div></div>'),e.put("/views/scarcityDisplay.html",'<md-icon md-svg-src="{{scarcityIcon()}}" class="name"></md-icon><span flex>{{scarcityText()}}</span>'),e.put("/views/skill.html",'<span class="skill"><span class="skill-name">{{name}}</span> <span ng-if="!minion"><span ng-if="!hideRank">{{rank}}</span> (<span ng-repeat="p in pdice track by $index"><proficiency></proficiency></span><span ng-repeat="a in adice track by $index"><ability></ability></span>)</span><span ng-if="minion"> (varies by number)</span></span>'),e.put("/views/skills.html",'<div class="npc-skills"><div class="npc-details-bold" ng-if="char.rank != \'minion\'">Skills:</div><div class="npc-details-bold" ng-if="char.rank == \'minion\'">Skills (group only):</div><div class="npc-details-normal" ng-repeat="key in skillKeys()"><skill name="key" rank="skills[key].rank" abty="getAttr(key)" minion="char.rank == \'minion\'"></skill><span ng-if="!$last">,</span><span ng-if="$last">.</span></div><div class="npc-details-normal" ng-if="skillKeys().length === 0">None.</div></div>'),e.put("/views/statbar.html",'<div class="stat-bar"><statblock display="Brawn" value="model.brawn"></statblock><statblock display="Agility" value="model.agility"></statblock><statblock display="Intellect" value="model.intellect"></statblock><statblock display="Cunning" value="model.cunning"></statblock><statblock display="Willpower" value="model.willpower"></statblock><statblock display="Presence" value="model.presence"></statblock></div>'),e.put("/views/statblock.html",'<div class="stat-block"><div class="stat-block-value">{{value}}</div><div class="stat-block-text">{{display}}</div></div>'),e.put("/views/talents.html",'<div class="npc-talents"><div class="npc-details-bold">Talents:</div><div class="npc-details-normal" ng-if="talents" dynamic="talents"></div><div class="npc-details-normal" ng-if="!talents">None.</div></div>')}]);